<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rocker Empire</title>

<style>
:root{
  --bg:#0b0b0b;
  --panel:#151515;
  --card:#1e1e1e;
  --accent:#b30000;
  --text:#fff;
}
*{box-sizing:border-box;font-family:system-ui}
body{margin:0;background:var(--bg);color:var(--text);overflow:hidden}

/* SCREENS */
.screen{display:none;height:100vh;width:100vw}
.screen.active{display:flex;flex-direction:column}

/* HUD */
#hud{
  display:flex;justify-content:space-between;
  padding:8px 12px;background:#111;border-bottom:1px solid #222
}

/* PANELS */
#content{flex:1;position:relative}
.panel{
  position:absolute;inset:0;
  background:var(--panel);padding:14px;
  transform:translateX(100%);
  transition:.3s ease;overflow-y:auto
}
.panel.active{transform:translateX(0)}

/* BOTTOM BAR */
#bottomBar{
  display:flex;justify-content:space-around;
  background:#111;border-top:1px solid #222
}
#bottomBar button{
  background:none;border:none;color:#888;padding:8px
}
#bottomBar button.active{
  color:#fff;border-bottom:2px solid var(--accent)
}

/* UI */
button{
  background:var(--accent);border:none;
  color:#fff;padding:10px;border-radius:8px;margin-top:6px
}
button.secondary{background:#333}
.card{background:var(--card);border-radius:12px;padding:14px;margin-bottom:12px}
.region{border:1px solid #333;border-radius:10px;padding:10px;margin-bottom:10px;cursor:pointer}
.bar{height:8px;background:#333;border-radius:6px;overflow:hidden}
.bar div{height:100%;background:var(--accent)}

.center{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%}
</style>
</head>

<body>

<!-- START -->
<section id="start" class="screen active">
  <div class="center">
    <h1>ğŸï¸ ROCKER EMPIRE</h1>
    <button onclick="go('chars')">SPIELEN</button>
  </div>
</section>

<!-- CHARAKTERE -->
<section id="chars" class="screen">
  <div class="center">
    <h2>Charaktere</h2>
    <div id="charList"></div>
    <button onclick="go('create')">+ Neuer Charakter</button>
    <button class="secondary" onclick="go('settings')">âš™ï¸ Einstellungen</button>
  </div>
</section>

<!-- EINSTELLUNGEN -->
<section id="settings" class="screen">
  <div class="center">
    <h2>Einstellungen</h2>
    <div class="card">
      <label>Grafik</label>
      <select id="setGraphics">
        <option>Niedrig</option><option>Mittel</option><option>Hoch</option>
      </select>
      <label>Audio</label>
      <select id="setAudio">
        <option>Aus</option><option>Leise</option><option>Laut</option>
      </select>
      <label>Modus</label>
      <select id="setMode">
        <option>Handy</option><option>PC</option>
      </select>
      <button onclick="saveSettings()">Speichern</button>
      <button class="secondary" onclick="go('chars')">ZurÃ¼ck</button>
    </div>
  </div>
</section>

<!-- CREATE -->
<section id="create" class="screen">
  <div class="center">
    <h2>Neuer Charakter</h2>
    <div class="card">
      <input id="nameInput" placeholder="Name">
      <select id="ligaInput">
        <option value="4">Liga 4 â€“ EigenstÃ¤ndig</option>
        <option value="3">Liga 3 â€“ Supporter</option>
      </select>
      <button onclick="createChar()">Erstellen</button>
      <button class="secondary" onclick="go('chars')">Abbrechen</button>
    </div>
  </div>
</section>

<!-- GAME -->
<section id="game" class="screen">
  <div id="hud">
    ğŸ’¶ <span id="hudMoney">0</span>
    ğŸ‘¥ <span id="hudMembers">0</span>
    ğŸ”« <span id="hudWeapons">0</span>
    ğŸ”¥ <span id="hudHeat">0%</span>
  </div>

  <div id="content">
    <div id="panel-char" class="panel active"></div>
    <div id="panel-map" class="panel"></div>
    <div id="panel-shop" class="panel"></div>
    <div id="panel-police" class="panel"></div>
    <div id="panel-region" class="panel"></div>
  </div>

  <div id="bottomBar">
    <button onclick="openPanel('char')" class="active">ğŸ‘¤</button>
    <button onclick="openPanel('map')">ğŸ—ºï¸</button>
    <button onclick="openPanel('shop')">ğŸª</button>
    <button onclick="openPanel('police')">ğŸš“</button>
  </div>
</section>

<script>
/* ===== TEIL 1 ENDET ===== */
/* ================= TEIL 2: DATEN ================= */

/* ---------- SAVE KEYS ---------- */
const SAVE_KEY_GAME = "rocker_empire_game_v9";
const SAVE_KEY_SETTINGS = "rocker_empire_settings_v1";

/* ---------- MCs ---------- */
const MCs = {
  "Hells Angels MC": {},
  "Bandidos MC": {},
  "Outlaws MC": {},
  "Pagans MC": {},
  "Sons of Silence": {}
};

/* ---------- ORTE (Deutschland komplett) ---------- */
const REGIONS = [
  { name:"Berlin", owner:"Hells Angels MC" },
  { name:"Brandenburg", owner:"Hells Angels MC" },
  { name:"Sachsen", owner:"Hells Angels MC" },

  { name:"Hamburg", owner:"Bandidos MC" },
  { name:"Niedersachsen", owner:"Bandidos MC" },
  { name:"Schleswig-Holstein", owner:"Bandidos MC" },

  { name:"NRW", owner:"Outlaws MC" },
  { name:"Hessen", owner:"Outlaws MC" },

  { name:"Bayern", owner:"Pagans MC" },
  { name:"Baden-WÃ¼rttemberg", owner:"Pagans MC" },

  { name:"ThÃ¼ringen", owner:"Sons of Silence" },
  { name:"Sachsen-Anhalt", owner:"Sons of Silence" },
  { name:"Mecklenburg-Vorpommern", owner:"Sons of Silence" }
];

/* ---------- LIGA-3 SUPPORTER ---------- */
const LIGA3_MCS = [
  "Bulldozer Cottbus",
  "Red Devils Support",
  "Support 81",
  "Free Riders",
  "Independent Brotherhood"
];

/* ---------- GESCHENKE (MIT PREISEN & %) ---------- */
const GIFTS = {
  small: {
    name: "Kleines Geschenk",
    priceMin: 1000,
    priceMax: 15000,
    gainMin: 1,
    gainMax: 3,
    cooldownHours: 5
  },
  big: {
    name: "GroÃŸes Geschenk",
    priceMin: 30000,
    priceMax: 60000,
    gainMin: 5,
    gainMax: 8,
    cooldownHours: 5
  },
  huge: {
    name: "Big Geschenk",
    priceMin: 90000,
    priceMax: 150000,
    gainMin: 9,
    gainMax: 11,
    cooldownHours: 8
  }
};

/* ---------- LEGALE SHOP-ITEMS ---------- */
const LEGAL_ITEMS = [
  { name:"Kleidung", price:200, effect:"stability" },
  { name:"Essen", price:100, effect:"stability" },
  { name:"GetrÃ¤nke", price:80, effect:"stability" },
  { name:"Verbandszeug", price:150, effect:"safety" }
];

/* ---------- MITGLIEDER ---------- */
const MEMBERS = [
  { name:"Prospect", price:500, risk:5 },
  { name:"Clubmitglied", price:1500, risk:10 },
  { name:"Fremder MC", price:800, risk:25 }
];

/* ---------- FAHRZEUGE ---------- */
const VEHICLES = [
  { name:"Schrottbike", price:5000, speed:20, power:15, safety:10, freedom:25 },
  { name:"Street Cruiser", price:25000, speed:40, power:35, safety:30, freedom:45 },
  { name:"Club Chopper", price:60000, speed:60, power:55, safety:50, freedom:65 },
  { name:"Elite Road King", price:100000, speed:80, power:75, safety:70, freedom:85 }
];

/* ---------- SPIELSTATE ---------- */
let state = {
  chars: []
};

let current = null;
let selectedRegion = null;

/* ---------- EINSTELLUNGEN STATE ---------- */
let settings = {
  graphics: "Mittel",
  audio: "Leise",
  mode: "Handy"
};

/* ================= TEIL 2 ENDET HIER ================= */
/* WEITER MIT TEIL 3 â€“ LOGIK, COOLDOWNS, SAVE */
/* ================= TEIL 3: LOGIK & VERHALTEN ================= */

/* ---------- NAV ---------- */
function go(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}
function openPanel(name){
  document.querySelectorAll(".panel").forEach(p=>p.classList.remove("active"));
  document.getElementById("panel-"+name).classList.add("active");
  document.querySelectorAll("#bottomBar button").forEach(b=>b.classList.remove("active"));
}

/* ---------- SAVE / LOAD ---------- */
function saveGame(){ localStorage.setItem(SAVE_KEY_GAME, JSON.stringify(state)); }
function loadGame(){
  const d=localStorage.getItem(SAVE_KEY_GAME);
  if(d) state=JSON.parse(d);
}
function saveSettings(){
  settings.graphics=document.getElementById("setGraphics").value;
  settings.audio=document.getElementById("setAudio").value;
  settings.mode=document.getElementById("setMode").value;
  localStorage.setItem(SAVE_KEY_SETTINGS, JSON.stringify(settings));
  applySettings();
  alert("Einstellungen gespeichert");
}
function loadSettings(){
  const s=localStorage.getItem(SAVE_KEY_SETTINGS);
  if(s) settings=JSON.parse(s);
}
function applySettings(){
  document.body.style.filter =
    settings.graphics==="Niedrig" ? "contrast(0.9) brightness(0.9)" :
    settings.graphics==="Hoch" ? "contrast(1.05) brightness(1.05)" : "none";
}

/* ---------- UTILS ---------- */
const now=()=>Date.now();
const rnd=(a,b)=>Math.floor(Math.random()*(b-a+1))+a;
const pct=v=>Math.max(0,Math.min(100,Math.round(v)));
function cdLeft(ts,h){
  if(!ts) return 0;
  return Math.max(0, h*3600000-(now()-ts));
}
function fmt(ms){
  const s=Math.ceil(ms/1000),h=Math.floor(s/3600),m=Math.floor((s%3600)/60),r=s%60;
  return (h?`${h}h `:"")+(m?`${m}m `:"")+`${r}s`;
}

/* ---------- CHAR CREATE ---------- */
function createChar(){
  const liga=+document.getElementById("ligaInput").value;
  state.chars.push({
    liga,
    name: liga===4?(document.getElementById("nameInput").value||"Rider"):"Supporter",
    mc: liga===4?"EigenstÃ¤ndig":"Supporter",
    money: liga===4?500:2000,
    members: liga===4?1:6,
    influence: liga===4?0:20,
    weapons:0, weed:0, heat:0,
    vehicle:null,
    relations:{}, lastAttack:{}
  });
  saveGame(); renderChars(); go("chars");
}

/* ---------- CHAR LIST ---------- */
function renderChars(){
  const c=document.getElementById("charList"); c.innerHTML="";
  state.chars.forEach((x,i)=>c.innerHTML+=
    `<button onclick="startGame(${i})">${x.name} (Liga ${x.liga})</button>`);
}
function startGame(i){ current=i; go("game"); renderGame(); }

/* ---------- GAME RENDER ---------- */
function ensureRel(p,mc){
  if(!p.relations[mc]) p.relations[mc]={friend:0};
  return p.relations[mc];
}
function renderGame(){
  const p=state.chars[current];
  hudMoney.textContent=p.money;
  hudMembers.textContent=p.members;
  hudWeapons.textContent=p.weapons;
  hudHeat.textContent=p.heat+"%";

  /* CHAR */
  document.getElementById("panel-char").innerHTML=`
    <div class="card">
      <strong>${p.name}</strong><br>
      Liga ${p.liga}<br>
      Club: ${p.mc}<br>
      Einfluss: ${p.influence}%<br>
      Fahrzeug: ${p.vehicle?p.vehicle.name:"Keins"}
    </div>`;

  /* MAP */
  document.getElementById("panel-map").innerHTML=REGIONS.map((r,i)=>{
    const rel=ensureRel(p,r.owner);
    return `<div class="region" onclick="openRegion(${i})">
      <strong>${r.name}</strong><br>
      Besitzer: ${r.owner}<br>
      Freundschaft: ${pct(rel.friend)}%
      <div class="bar"><div style="width:${pct(rel.friend)}%"></div></div>
    </div>`;
  }).join("");

  /* SHOP */
  document.getElementById("panel-shop").innerHTML=`
    <div class="card"><h3>Geschenke</h3>
      ${Object.values(GIFTS).map(g=>`
        <div>${g.name}: ${g.priceMin}â€“${g.priceMax}â‚¬ (+${g.gainMin}â€“${g.gainMax}%)</div>
      `).join("")}
      <small>Geschenke werden im Orts-Panel Ã¼bergeben</small>
    </div>
    <div class="card"><h3>Legales</h3>
      ${LEGAL_ITEMS.map(i=>`<button onclick="buyLegal(${i.price})">${i.name} â€“ ${i.price}â‚¬</button>`).join("")}
    </div>
    <div class="card"><h3>Mitglieder</h3>
      ${MEMBERS.map(m=>`<button onclick="hireMember(${m.price},${m.risk})">${m.name} â€“ ${m.price}â‚¬</button>`).join("")}
    </div>
    <div class="card"><h3>Fahrzeuge</h3>
      ${VEHICLES.map((v,i)=>`
        <button onclick="buyVehicle(${i})">
          ${v.name} â€“ ${v.price}â‚¬ | âš¡${v.speed}% ğŸ’ª${v.power}% ğŸ›¡ï¸${v.safety}% ğŸ•Šï¸${v.freedom}%
        </button>`).join("")}
    </div>
    <div class="card"><h3>Waffen</h3>
      ${Object.keys(MCs).map(mc=>`<button onclick="buyWeapon('${mc}')">ğŸ”« von ${mc}</button>`).join("")}
    </div>`;

  /* POLICE */
  document.getElementById("panel-police").innerHTML=`
    <div class="card">
      Heat: ${p.heat}%<br>
      <button onclick="bribePolice()">ğŸ’¸ Polizei schmieren</button>
    </div>`;
}

/* ---------- REGION PANEL ---------- */
function openRegion(idx){
  selectedRegion=idx;
  const r=REGIONS[idx], p=state.chars[current], rel=ensureRel(p,r.owner);
  const cdReq=cdLeft(rel.lastReq,1);
  const cdV=cdLeft(rel.lastVisit,2);
  const cdS=cdLeft(rel.lastGiftSmall, GIFTS.small.cooldownHours);
  const cdB=cdLeft(rel.lastGiftBig, GIFTS.big.cooldownHours);
  const cdH=cdLeft(rel.lastGiftHuge, GIFTS.huge.cooldownHours);

  document.getElementById("panel-region").innerHTML=`
    <div class="card">
      <strong>${r.name}</strong><br>MC: ${r.owner}<br>
      Freundschaft: ${pct(rel.friend)}%
      <div class="bar"><div style="width:${pct(rel.friend)}%"></div></div>
    </div>

    <div class="card">
      <button ${cdReq?"disabled":""} onclick="requestFriend('${r.owner}')">
        ğŸ¤ Freundschaft anfragen ${cdReq?`(${fmt(cdReq)})`:""}
      </button>
    </div>

    <div class="card">
      <button ${cdS?"disabled":""} onclick="giveGift('${r.owner}','small')">
        ğŸ Klein (${GIFTS.small.priceMin}â€“${GIFTS.small.priceMax}â‚¬)
      </button>
      <button ${cdB?"disabled":""} onclick="giveGift('${r.owner}','big')">
        ğŸ GroÃŸ (${GIFTS.big.priceMin}â€“${GIFTS.big.priceMax}â‚¬)
      </button>
      <button ${cdH?"disabled":""} onclick="giveGift('${r.owner}','huge')">
        ğŸ Big (${GIFTS.huge.priceMin}â€“${GIFTS.huge.priceMax}â‚¬)
      </button>
    </div>

    <div class="card">
      <button ${(rel.friend<1||cdV)?"disabled":""} onclick="visitMC('${r.owner}')">
        ğŸï¸ Besuch ${cdV?`(${fmt(cdV)})`:""}
      </button>
    </div>

    <div class="card">
      <button onclick="attackMC('${r.owner}')">âš”ï¸ Angriff</button>
    </div>

    <button class="secondary" onclick="openPanel('map')">SchlieÃŸen</button>`;
  openPanel("region");
}

/* ---------- ACTIONS ---------- */
function requestFriend(mc){
  const p=state.chars[current], rel=ensureRel(p,mc);
  rel.lastReq=now();
  if(Math.random()<0.2){ rel.friend=Math.max(1,rel.friend); alert("Angenommen"); }
  else{ rel.friend=pct(rel.friend-1); alert("Abgelehnt"); }
  saveGame(); renderGame(); openRegion(selectedRegion);
}
function giveGift(mc,type){
  const p=state.chars[current], rel=ensureRel(p,mc), g=GIFTS[type];
  const price=rnd(g.priceMin,g.priceMax);
  if(p.money<price) return alert("Nicht genug Geld");
  p.money-=price; rel.friend=pct(rel.friend+rnd(g.gainMin,g.gainMax));
  rel["lastGift"+type.charAt(0).toUpperCase()+type.slice(1)]=now();
  saveGame(); renderGame(); openRegion(selectedRegion);
}
function visitMC(mc){
  const p=state.chars[current], rel=ensureRel(p,mc);
  rel.lastVisit=now();
  const reject=Math.max(0.1,1-rel.friend/100);
  if(Math.random()<reject) alert("Besuch abgelehnt");
  else{ p.influence=pct(p.influence+2); rel.friend=pct(rel.friend+1); alert("Besuch erfolgreich"); }
  saveGame(); renderGame(); openRegion(selectedRegion);
}
function attackMC(mc){
  const p=state.chars[current];
  if(p.weapons<1) return alert("Keine Waffen");
  p.weapons--; p.heat=pct(p.heat+15); p.influence=pct(p.influence+5);
  const rel=ensureRel(p,mc); rel.friend=pct(rel.friend-15);
  p.lastAttack[mc]=now();
  alert("Angriff! Gegenschlag mÃ¶glich.");
  saveGame(); renderGame(); openRegion(selectedRegion);
}

/* ---------- SHOP ---------- */
function buyLegal(price){
  const p=state.chars[current];
  if(p.money<price) return;
  p.money-=price; p.heat=pct(p.heat-2);
  saveGame(); renderGame();
}
function hireMember(price,risk){
  const p=state.chars[current];
  if(p.money<price) return;
  p.money-=price; p.members++; p.heat=pct(p.heat+risk);
  saveGame(); renderGame();
}
function buyVehicle(i){
  const p=state.chars[current], v=VEHICLES[i];
  if(p.money<v.price) return;
  p.money-=v.price; p.vehicle=v;
  saveGame(); renderGame();
}
function buyWeapon(mc){
  const p=state.chars[current], rel=ensureRel(p,mc);
  if(rel.friend<50) return alert("Kein Vertrauen");
  if(p.money<1000) return;
  p.money-=1000; p.weapons++; p.heat=pct(p.heat+8);
  saveGame(); renderGame();
}
function bribePolice(){
  const p=state.chars[current], cost=p.liga===4?1000:3000;
  if(p.money<cost) return;
  p.money-=cost; p.heat=pct(p.heat-25);
  saveGame(); renderGame();
}

/* ---------- INIT ---------- */
loadSettings(); applySettings();
loadGame(); renderChars();

/* ================= ENDE ================= */
</script>
</body>
</html>
